{% assign sec_id = section.id | slice: -6, 6 | replace: '-', '_' %}
{% assign sec_id = sec_id | prepend: 'pw' %}

{% style %}
#shopify-section-{{ section.id }} {
  padding-top: {{ section.settings.section_padding_top_m }}px;
  padding-bottom: {{ section.settings.section_padding_bottom_m }}px;
}
@media screen and (min-width: 750px) {
  #shopify-section-{{ section.id }} {
  padding-top: {{ section.settings.section_padding_top_d }}px;
  padding-bottom: {{ section.settings.section_padding_bottom_d }}px;
  }
}
{% endstyle %}

<div class="pw-main-section pw-section__{{sec_id}}">
  <div class="pw-layout">
    <div class="pw-sidebar-wrapper">
      <div class="pw-sidebar">
        <div class="pw-sidebar-inner">
          <ul class="pw-sidebar-menu">
            <li class="current">
              <a href="/">All categories</a>
            </li>
            {% for collection in collections %}
              {% if collection.metafields.appstore.in_sidebar == true %}
                <li class="{% if collection.metafields.appstore.popular == true %} popular {% endif %}">
                  <a href="{{ collection.url }}">{{ collection.title }}</a>
                </li>
              {% endif %}
            {% endfor %}
          </ul>
        </div>
      </div>
    </div>

    <div class="pw-main-wrapper">
      <div class="pw-main ">

        <div class="pw-main-search-wrapper">
          <div class="pw-row">

            <div class="pw-col-lg-8">
              <div class="search-content">

                {% assign placeholder = 'accessibility.app_search_placeholder' | t %}

                <div class="">
                {% render 'sec-heading-1' | align: 'left', class: "search-content__title" %}

                {% render 'sec-description' %}
                </div>
                {% render 'search-field' | input_name: "homepage-search" , placeholder: placeholder , search_type: "product" %}
              </div>
            </div>

            <div class="pw-col-lg-4">
              <a href="{{ section.settings.header_product_link }}" class="pw-header-product-wrapper">
              {% if section.settings.header_product_image != blank %}
                <div class="pw-header-product-img">
                 {{ section.settings.header_product_image | image_url: width: 600 | image_tag }}
                </div>
              {% endif %}
              {% if section.settings.header_product_title != blank %}
                <div class="pw-header-product-title">
                 {{ section.settings.header_product_title }}
                </div>
              {% endif %}
              {% if section.settings.header_product_text != blank %}
                <div class="pw-header-product-text">
                 {{ section.settings.header_product_text }}
                </div>
              {% endif %}
              </a>
            </div>

          </div>

        </div>

        <div class="pw-products__list">

          <div class="category-filter-wrapper">

            <div class="pw-select-wrapper pw-sidebar-menu-mobile ">
              <select class="pw-sidebar-menu">
                <option value="" data-value="/">All categories</option>
                {% for collection in collections %}
                {% if collection.metafields.appstore.parent == blank %}
                <option value="{{ collection.url }}">{{ collection.title }}</option>
                {% endif %}
                {% endfor %}
              </select>
            </div>

            <div class="pw-select-wrapper pw-product-tabs">
              <select name="select-tabs" class="pw-main-select-tabs">
                <option value="popular" selected>Popular</option>
                <option value="free"> Free</option>
                <option value="recent"> Recent</option>
             </select>
           </div>

          </div>

          <div class="pw-product-tabs-wrapper">

            {% assign sorted_products = collections.all.products | sort: 'price' | reverse %}

            <div class="pw-product-tab-content active" data-content="popular">
              <div class="pw-row">
                {% for product in sorted_products limit: 9 %}
                <div class="pw-col-xl-4 pw-col-lg-6 pw-col-md-12 pw-col-sm-6">
                  {% render 'product-card', product: product %}
                </div>
                {% endfor %}
              </div>
              <a class="link-to " href="/collections/all-shopify-apps">
                View all
                <svg aria-hidden="true" focusable="false" role="presentation" width="20" height="20" viewBox="0 0 20 20" fill="none" class="icon icon-arrow">
                  <path d="M12.2559 4.41083L16.9699 9.12486C17.2954 9.45028 17.2954 9.97795 16.9699 10.3034L12.2559 15.0174C11.9305 15.3429 11.4028 15.3429 11.0774 15.0174C10.7519 14.692 10.7519 14.1644 11.0774 13.8389L14.3688 10.5474H3.33333C2.8731 10.5474 2.5 10.1744 2.5 9.71411C2.5 9.25386 2.8731 8.88078 3.33333 8.88078H14.3688L11.0774 5.58934C10.7519 5.2639 10.7519 4.73626 11.0774 4.41083C11.4028 4.08539 11.9305 4.08539 12.2559 4.41083Z" fill="currentColor"></path>
                </svg>
              </a>
            </div>

            <div class="pw-product-tab-content" data-content="free">
              <div class="pw-row">
                {% assign product_counter = 0 %}
                {% for product in sorted_products %}
                  {% if product.metafields.appstore.only_free_plan.value == 'true' and product_counter < 9 %}
                    <div class="pw-col-xl-4 pw-col-lg-6 pw-col-md-12 pw-col-sm-6">
                    {% render 'product-card', product: product %}
                    </div>
                    {% assign product_counter = product_counter | plus: 1 %}
                  {% endif %}
                {% endfor %}
              </div>
              <a class="link-to " href="/collections/all-shopify-apps?filter.p.m.appstore.only_free_plan=true">
                View all
                <svg aria-hidden="true" focusable="false" role="presentation" width="20" height="20" viewBox="0 0 20 20" fill="none" class="icon icon-arrow">
                  <path d="M12.2559 4.41083L16.9699 9.12486C17.2954 9.45028 17.2954 9.97795 16.9699 10.3034L12.2559 15.0174C11.9305 15.3429 11.4028 15.3429 11.0774 15.0174C10.7519 14.692 10.7519 14.1644 11.0774 13.8389L14.3688 10.5474H3.33333C2.8731 10.5474 2.5 10.1744 2.5 9.71411C2.5 9.25386 2.8731 8.88078 3.33333 8.88078H14.3688L11.0774 5.58934C10.7519 5.2639 10.7519 4.73626 11.0774 4.41083C11.4028 4.08539 11.9305 4.08539 12.2559 4.41083Z" fill="currentColor"></path>
                </svg>
              </a>
            </div>

            <div class="pw-product-tab-content" data-content="recent">
              <div class="pw-row">
                {% assign newest_products = collections.all.products | sort: 'created_at' | reverse %}
                {% for product in newest_products limit: 9 %}
                  <div class="pw-col-xl-4 pw-col-lg-6 pw-col-md-12 pw-col-sm-6">
                    {% render 'product-card', product: product %}
                  </div>
                {% endfor %}
              </div>
              <a class="link-to " href="/collections/all-shopify-apps?sort_by=price-descending">
                View all
                <svg aria-hidden="true" focusable="false" role="presentation" width="20" height="20" viewBox="0 0 20 20" fill="none" class="icon icon-arrow">
                  <path d="M12.2559 4.41083L16.9699 9.12486C17.2954 9.45028 17.2954 9.97795 16.9699 10.3034L12.2559 15.0174C11.9305 15.3429 11.4028 15.3429 11.0774 15.0174C10.7519 14.692 10.7519 14.1644 11.0774 13.8389L14.3688 10.5474H3.33333C2.8731 10.5474 2.5 10.1744 2.5 9.71411C2.5 9.25386 2.8731 8.88078 3.33333 8.88078H14.3688L11.0774 5.58934C10.7519 5.2639 10.7519 4.73626 11.0774 4.41083C11.4028 4.08539 11.9305 4.08539 12.2559 4.41083Z" fill="currentColor"></path>
                </svg>
              </a>
            </div>

          </div>

        </div>
      </div>
    </div>
  </div>
</div>


<script src="{{ 'snippets-search-field.js' | asset_url }}" defer="defer"></script>

<script src="{{ 'sections-collection-products.js' | asset_url }}" defer="defer"></script>

<script>
   document.addEventListener("DOMContentLoaded", function(){
  let categorySelect = document.querySelector('select.pw-sidebar-menu');
  categorySelect.addEventListener('change', function(e){
    e.preventDefault();
    let path = e.target.value;
    window.location.href = path;
  });
   });
</script>


{% schema %}

{
  "name": "Main page new",
  "class": "section",
  "tag": "section",
  "blocks": [],
  "presets": [
    {
      "name": "Main home section"
    }
  ],
  "settings": [
    {
      "type": "range",
      "id": "section_padding_top_m",
      "label": "Section Padding Top (mobile)",
      "min": 0,
      "max": 200,
      "step": 2,
      "default": 0,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "section_padding_bottom_m",
      "label": "Section Padding Bottom (mobile)",
      "min": 0,
      "max": 200,
      "step": 2,
      "default": 0,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "section_padding_top_d",
      "label": "Section Padding Top (desktop)",
      "min": 0,
      "max": 200,
      "step": 2,
      "default": 0,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "section_padding_bottom_d",
      "label": "Section Padding Bottom (desktop)",
      "min": 0,
      "max": 200,
      "step": 2,
      "default": 0,
      "unit": "px"
    },
    {
      "type": "richtext",
      "id": "heading",
      "label": "Section title",
      "default": "<p>Find <b>the best app</b> for your Shopify store tailored to</p>"
    },
    {
      "type": "text",
      "id": "description",
      "label": "Section description",
      "default": "Unleash your creativity with out-of-this-world app inspiration from across Shopify"
    },
    {
      "type": "image_picker",
      "id": "header_product_image",
      "label": "Header Image"
    },
    {
      "type": "text",
      "id": "header_product_title",
      "label": "Header product title",
      "default": "Faire: Sell Wholesale"
    },
    {
      "type": "text",
      "id": "header_product_text",
      "label": "Header product text",
      "default": "Sell wholesale to independent retailers worldwide"
    },
    {
      "type": "url",
      "id": "header_product_link",
      "label": "Header product link"
    },
    {
      "type": "image_picker",
      "id": "background",
      "label": "Custom background"
    }
  ]
}

{% endschema %}
